/* ---------- Base & theme variables ---------- */
* { box-sizing: border-box; }
html, body { height: 100%; }

:root {
  --text: #e5e7eb;             /* DARK (default) */
  --subtext: #f3ecd0;
  --panel-bg: rgba(255,255,255,0.06);
  --panel-border: rgba(255,255,255,0.045);
  --input-bg: rgba(255,255,255,0.07);
  --input-border: rgba(255, 227, 130, 0.45);
  --gold-1: #b8860b;
  --gold-2: #d4af37;
  --gold-3: #c9a227;
  --gold-shadow-1: rgba(205, 160, 45, 0.55);
  --gold-shadow-2: rgba(222, 186, 74, 0.75);
  --bg-fallback: #050814;
  --title-glow-a: rgba(255, 230, 150, 0.40);
  --title-glow-b: rgba(255, 220, 120, 0.30);
  --title-glow-c: rgba(255, 210, 100, 0.22);
}

/* Light theme — moving YELLOW background, black text, pastel blue accents */
body.theme-light {
  --text: #0b0b0b;
  --subtext: #0b0b0b;
  --panel-bg: rgba(255,255,255,0.70);
  --panel-border: rgba(0,0,0,0.06);
  --input-bg: rgba(0,0,0,0.04);
  --input-border: rgba(201, 162, 39, 0.60);
  --gold-shadow-1: rgba(201,162,39,0.55);
  --gold-shadow-2: rgba(212,175,55,0.70);
  --bg-fallback: #fffbe6; /* light yellow fallback */
  --title-glow-a: rgba(212, 175, 55, 0.28);
  --title-glow-b: rgba(201, 162, 39, 0.24);
  --title-glow-c: rgba(184, 134, 11, 0.20);

  /* Light-mode blue palette (used by border + login button) */
  --blue-1: #cfe1ff;
  --blue-2: #bdd6ff;
  --blue-3: #aecdff;
}

body {
  margin: 0;
  font-family: "Cinzel Decorative", serif;
  color: var(--text);
  min-height: 100dvh;
  overflow: hidden;
  background: var(--bg-fallback);
  /* global color easing so non-gradient bits fade too */
  transition:
    color .45s ease,
    background-color .45s ease,
    border-color .45s ease,
    box-shadow .45s ease,
    text-shadow .45s ease,
    filter .45s ease;
}

/* Animated gradient (dark & light variants) */
.animated-bg {
  position: fixed; inset: 0; z-index: -3;
  background: linear-gradient(135deg,
    #030616, #0a0f3c, #0d1b2a, #13223f,
    #1b2a4a, #243b6b, #0e2a47, #030616);
  background-size: 600% 600%;
  animation: gradientShift 45s ease-in-out infinite;
}
body.theme-light .animated-bg {
  background: linear-gradient(135deg,
    #fffbe6,  /* very light yellow */
    #fff4bf,
    #ffe98a,
    #ffdf66,
    #ffe98a,
    #fff4bf,
    #fffbe6
  );
  background-size: 500% 500%;
  animation: gradientShift 18s ease-in-out infinite;
}

.space-vignette {
  position: fixed; inset: 0; z-index: -2; pointer-events: none;
  background:
    radial-gradient(120vw 120vh at 50% 30%, rgba(255,255,255,0.05), transparent 55%),
    radial-gradient(120vw 120vh at 50% 120%, rgba(0,0,0,0.45), transparent 60%);
  mix-blend-mode: soft-light;
}
body.theme-light .space-vignette {
  background:
    radial-gradient(120vw 120vh at 50% 30%, rgba(0,0,0,0.06), transparent 55%),
    radial-gradient(120vw 120vh at 50% 120%, rgba(0,0,0,0.10), transparent 60%);
}

/* Star layers (hidden in light mode) */
.diamond-layer,
.diamond-mini-layer,
.shooting-layer {
  position: fixed; inset: 0; z-index: -1;
  pointer-events: none; overflow: hidden;
}
body.theme-light .diamond-layer,
body.theme-light .diamond-mini-layer,
body.theme-light .shooting-layer {
  display: none !important;
}

/* Dark-mode stars */
.diamond,
.diamond-mini {
  position: absolute;
  transform: translate(-50%,-50%) rotate(45deg) scale(1);
  border-radius: 2px;
  background: linear-gradient(145deg, rgba(255,255,224,0.95), rgba(255,255,255,0.85));
  opacity: 0.85;
  animation: diamondTwinkle var(--twinkle, 6s) ease-in-out infinite;
  will-change: transform, opacity;
}
.diamond { width: var(--size, 4px); height: var(--size, 4px);
  box-shadow: 0 0 8px rgba(255,255,224,0.38), 0 0 16px rgba(255,255,180,0.25);
}
.diamond-mini { width: var(--size, 2px); height: var(--size, 2px);
  box-shadow: 0 0 6px rgba(255,255,224,0.28), 0 0 12px rgba(255,255,180,0.18);
}

@keyframes diamondTwinkle {
  0%   { transform: translate(-50%,-50%) rotate(45deg) scale(0.82); opacity: 0.15; }
  25%  { transform: translate(-50%,-50%) rotate(45deg) scale(1.04); opacity: 0.78; }
  50%  { transform: translate(-50%,-50%) rotate(45deg) scale(0.95); opacity: 0.50; }
  75%  { transform: translate(-50%,-50%) rotate(45deg) scale(1.10); opacity: 0.90; }
  100% { transform: translate(-50%,-50%) rotate(45deg) scale(0.82); opacity: 0.18; }
}

@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50%{ background-position: 100% 50%; }
  100%{background-position: 0% 50%; }
}

/* Topbar toggle */
.topbar {
  position: fixed; top: 14px; right: 14px; z-index: 2;
  display: flex; gap: 10px;
}
.theme-toggle {
  appearance: none; border: 0; cursor: pointer;
  background: rgba(0,0,0,0.35);
  color: #fff; padding: 8px 10px; border-radius: 999px;
  box-shadow: 0 10px 28px rgba(0,0,0,0.35), 0 0 12px var(--gold-shadow-1);
  display: inline-flex; align-items: center; justify-content: center;
  transition: background-color .45s ease, box-shadow .45s ease, color .45s ease;
}
.theme-toggle:focus-visible { outline: 3px solid #d4af37; outline-offset: 3px; }
.theme-toggle .icon { width: 22px; height: 22px; display: none; }
.theme-toggle .icon-sun { display: inline-block; }
body.theme-light .theme-toggle .icon-sun { display: none; }
body.theme-light .theme-toggle .icon-moon { display: inline-block; }
body.theme-light .theme-toggle {
  background: rgba(255,255,255,0.85);
  color: #0c0c0c;
  box-shadow: 0 10px 28px rgba(0,0,0,0.12), 0 0 10px rgba(30,90,220,0.45);
}

.visually-hidden {
  position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0, 0, 1px, 1px); white-space: nowrap; border: 0;
}

/* Centered card */
.content.login-center {
  position: relative; z-index: 1;
  display: grid; place-items: center;
  width: 100vw; height: 100vh;
  padding: 20px;
}

/* Floating card */
.login-card {
  position: relative;
  width: min(92vw, 480px);
  padding: 36px 28px 30px;
  border-radius: 26px;
  background: var(--panel-bg);
  backdrop-filter: blur(12px) saturate(120%);
  box-shadow:
    0 28px 70px rgba(0,0,0,0.58),
    inset 0 0 0 1px var(--panel-border);
  transform: translateY(-4px);
  animation: floatY 8s ease-in-out infinite;
  transition: background-color .45s ease, box-shadow .45s ease, border-color .45s ease;
}
@keyframes floatY {
  0%   { transform: translateY(-4px); }
  50%  { transform: translateY(-12px); }
  100% { transform: translateY(-4px); }
}

/* BORDER: gold in DARK, lighter BLUE gradient in LIGHT (moving subtly) */
.gold-border-sparkle {
  pointer-events: none;
  position: absolute; inset: -8px;
  border-radius: 34px;
  padding: 8px;
  background:
    linear-gradient(135deg, var(--gold-1), var(--gold-2), var(--gold-3), var(--gold-2), var(--gold-1));
  background-size: 220% 220%;
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude;
  animation: borderFlow 5.2s linear infinite, goldGlow 4.8s ease-in-out infinite alternate;
  filter: drop-shadow(0 0 12px var(--gold-shadow-1));
}
@keyframes borderFlow { 0% { background-position: 0% 50%; } 100% { background-position: 200% 50%; } }
@keyframes goldGlow {
  0%   { filter: drop-shadow(0 0 12px var(--gold-shadow-1)) brightness(1); }
  100% { filter: drop-shadow(0 0 18px var(--gold-shadow-2)) brightness(1.08); }
}
/* LIGHT border overrides: pastel light-blue gradient, subtle motion */
body.theme-light .gold-border-sparkle {
  background: linear-gradient(135deg, var(--blue-1), var(--blue-2), var(--blue-3), var(--blue-2), var(--blue-1));
  background-size: 300% 300%;
  animation: lightBlueDrift 28s ease-in-out infinite, blueSoftGlow 6.2s ease-in-out infinite alternate;
  filter: drop-shadow(0 0 10px rgba(120, 170, 255, 0.40));
}

@keyframes lightBlueDrift {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 60% 50%; }
  100% { background-position: 0% 50%; }
}
@keyframes blueSoftGlow {
  0%   { filter: drop-shadow(0 0 10px rgba(120,170,255,0.40)) brightness(1.00); }
  100% { filter: drop-shadow(0 0 14px rgba(120,170,255,0.50)) brightness(1.03); }
}

.gold-border-sparkle::after {
  content: "";
  position: absolute; inset: 0; border-radius: inherit;
  background:
    radial-gradient(7px 7px at 12% 28%, rgba(255,245,180,0.9), transparent 55%),
    radial-gradient(6px 6px at 72% 62%, rgba(255,240,170,0.85), transparent 55%),
    radial-gradient(5px 5px at 38% 82%, rgba(255,235,160,0.9), transparent 55%),
    radial-gradient(4px 4px at 88% 18%, rgba(255,245,190,0.8), transparent 55%),
    radial-gradient(3px 3px at 30% 10%, rgba(255,255,200,0.7), transparent 55%);
  mix-blend-mode: screen;
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude;
  padding: 8px;
  animation: glitterRun 7s linear infinite;
}
body.theme-light .gold-border-sparkle::after {
  background:
    radial-gradient(7px 7px at 12% 28%, rgba(205,220,255,0.70), transparent 55%),
    radial-gradient(6px 6px at 72% 62%, rgba(195,215,255,0.65), transparent 55%),
    radial-gradient(5px 5px at 38% 82%, rgba(190,212,255,0.68), transparent 55%),
    radial-gradient(4px 4px at 88% 18%, rgba(200,222,255,0.62), transparent 55%),
    radial-gradient(3px 3px at 30% 10%, rgba(210,228,255,0.58), transparent 55%);
  opacity: 0.9;
}
@keyframes glitterRun {
  0%   { transform: rotate(0deg);   filter: brightness(1.04); }
  50%  { transform: rotate(180deg); filter: brightness(1.08); }
  100% { transform: rotate(360deg); filter: brightness(1.04); }
}

/* Title */
.login-title {
  margin: 4px 0 8px;
  font-size: clamp(1.8rem, 3.6vw, 2.6rem);
  letter-spacing: 0.04em;
  color: #fff9df;
  text-align: center;
  text-shadow:
    0 0 10px var(--title-glow-a),
    0 0 18px var(--title-glow-b),
    0 0 28px var(--title-glow-c);
  animation: titleGlowPulse 5.6s ease-in-out infinite;
  transition: color .45s ease, text-shadow .45s ease;
}
body.theme-light .login-title { color: #0b0b0b; text-shadow:
  0 0 10px rgba(212,175,55,0.22), 0 0 18px rgba(201,162,39,0.20); }

@keyframes titleGlowPulse {
  0%,100% { text-shadow:
    0 0 8px  var(--title-glow-a),
    0 0 16px var(--title-glow-b),
    0 0 24px var(--title-glow-c); }
  50% { text-shadow:
    0 0 12px rgba(255, 240, 170, 0.55),
    0 0 22px rgba(255, 232, 150, 0.45),
    0 0 34px rgba(255, 225, 140, 0.35); }
}

/* Forms */
.form-stack { display: grid; gap: 14px; }
.field { display: grid; gap: 6px; }
.field > span { font-size: 0.95rem; color: #ffeaa8; letter-spacing: 0.02em; text-shadow: 0 0 8px rgba(255,230,150,0.35); transition: color .45s ease; }
body.theme-light .field > span { color: #0b0b0b; text-shadow: none; }

input[type="text"], input[type="password"] {
  width: 100%;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  outline: none;
  transition: box-shadow .2s ease, border-color .2s ease, background .2s ease, color .45s ease, background-color .45s ease;
  font-family: "Cinzel Decorative", serif;
  box-shadow: 0 0 0 0 rgba(241, 209, 121, 0);
}
input::placeholder { color: rgba(127,127,127,0.6); }
body:not(.theme-light) input::placeholder { color: rgba(255,255,255,0.55); }
input:focus {
  border-color: var(--gold-2);
  box-shadow: 0 0 0 3px rgba(241, 209, 121, 0.28), 0 8px 28px rgba(241, 209, 121, 0.15);
  background: color-mix(in srgb, var(--input-bg), #ffffff 10%);
}

/* Buttons (default gold) */
.btn {
  width: 100%;
  padding: 12px 14px;
  border-radius: 14px;
  font-weight: 700; letter-spacing: 0.04em;
  cursor: pointer; border: 0; transform: translateZ(0);
  font-family: "Cinzel Decorative", serif;
}
.btn-gold {
  background: linear-gradient(135deg, var(--gold-2), var(--gold-3));
  color: #0b0b0b;
  box-shadow: 0 10px 28px rgba(212, 175, 55, 0.28), 0 0 18px rgba(212, 175, 55, 0.45);
  transition: filter .15s ease, transform .15s ease, box-shadow .2s ease, background-color .45s ease, color .45s ease;
}
.btn-gold:hover { filter: brightness(1.06); box-shadow:
  0 12px 34px rgba(212, 175, 55, 0.34),
  0 0 22px rgba(212, 175, 55, 0.55); }
.btn-gold:active { transform: translateY(1px); }

/* LIGHT MODE: only the LOGIN button turns pastel blue (animated) */
body.theme-light #loginForm .btn-gold {
  background: linear-gradient(135deg, var(--blue-1), var(--blue-2), var(--blue-3));
  background-size: 260% 260%;
  animation: loginBlueDrift 24s ease-in-out infinite;
  color: #0b0b0b;
  box-shadow:
    0 10px 26px rgba(120, 170, 255, 0.28),
    0 0 14px rgba(120, 170, 255, 0.40);
}
body.theme-light #loginForm .btn-gold:hover {
  filter: brightness(1.04);
  box-shadow:
    0 12px 32px rgba(120, 170, 255, 0.34),
    0 0 18px rgba(120, 170, 255, 0.52);
}
@keyframes loginBlueDrift {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 60% 50%; }
  100% { background-position: 0% 50%; }
}

.btn-ghost {
  background: rgba(255,255,255,0.09);
  color: #fff4cf;
  border: 1px solid rgba(212, 175, 55, 0.35);
  box-shadow: 0 8px 22px rgba(0,0,0,0.2), 0 0 12px rgba(212,175,55,0.28);
  transition: background-color .45s ease, color .45s ease, border-color .45s ease, box-shadow .45s ease;
}
body.theme-light .btn-ghost {
  background: rgba(255,255,255,0.92);
  color: #0b0b0b;
  border-color: rgba(0,0,0,0.12);
}

.or-row {
  display: grid; grid-template-columns: 1fr auto 1fr; align-items: center;
  gap: 10px; margin: 12px 0 10px; opacity: 0.9;
}
.or-row > span { display: block; height: 1px; background: linear-gradient(90deg, transparent, rgba(255,241,170,0.6), transparent); transition: background .45s ease; }
body.theme-light .or-row > span { background: linear-gradient(90deg, transparent, rgba(0,0,0,0.25), transparent); }

.status { min-height: 1.2em; margin-top: 10px; color: #ffe7a6; text-align: center; text-shadow: 0 0 8px rgba(255,230,150,0.25); transition: color .45s ease, text-shadow .45s ease; }
body.theme-light .status { color: #0b0b0b; text-shadow: none; }

/* Utility */
.hidden { display: none !important; }

/* ===== THEME TOGGLE GRADIENT CROSSFADE (NO FLASH) ===== */
/* We use a two-layer overlay: current gradient (from-layer) and target gradient (to-layer).
   The "FADE" happens by animating .to-layer opacity from 0 → 1. */

body.theme-transitioning * { transition: none !important; }

.mode-xfade {
  position: fixed;
  inset: 0;
  z-index: 9999;
  pointer-events: none;
}
.mode-xfade .layer {
  position: absolute;
  inset: 0;
  opacity: 1;
  background-size: 600% 600%;
}
.mode-xfade .from-layer { opacity: 1; }   /* current mode's gradient */
.mode-xfade .to-layer   { opacity: 0; }   /* target mode's gradient (will fade-in) */

/* gradients match .animated-bg of each mode */
.mode-xfade .is-dark {
  background: linear-gradient(135deg,
    #030616, #0a0f3c, #0d1b2a, #13223f, #1b2a4a, #243b6b, #0e2a47, #030616);
  animation: gradientShift 45s ease-in-out infinite;
}
.mode-xfade .is-light {
  background: linear-gradient(135deg,
    #fffbe6, #fff4bf, #ffe98a, #ffdf66, #ffe98a, #fff4bf, #fffbe6);
  animation: gradientShift 18s ease-in-out infinite;
}

/* >>> THIS is the FADE: the to-layer opacity animates 0 → 1 <<< */
.mode-xfade .to-layer.fade-in { animation: xfadeTo 680ms ease both; }
@keyframes xfadeTo { from { opacity: 0; } to { opacity: 1; } }

/* After swapping themes under full cover, we soften out the overlay */
.mode-xfade.fade-out { animation: xfadeOut 240ms ease both; }
@keyframes xfadeOut { from { opacity: 1; } to { opacity: 0; } }

/* Reduced motion: quicker fade */
@media (prefers-reduced-motion: reduce) {
  .mode-xfade .to-layer.fade-in { animation-duration: 240ms; }
  .mode-xfade.fade-out { animation-duration: 160ms; }
}

/* ========== Login card slow reveal during theme toggle ========== */
.login-card.card-hiding { opacity: 0; transform: translateY(10px) scale(0.985); }
.login-card.card-reveal { 
  animation: cardReveal 1100ms  cubic-bezier(.2,.6,.2,1) both; 
  animation-delay: 650ms;
}

@keyframes cardReveal {
  from { opacity: 0; transform: translateY(12px) scale(0.985); }
  to   { opacity: 1; transform: translateY(0)    scale(1); }
}
/* Perf hint */
.login-card { will-change: opacity, transform; }

/* Reduced motion (general) */
@media (prefers-reduced-motion: reduce) {
  .animated-bg { animation: none; }
  .diamond, .diamond-mini { animation: none; }
  .shooting-layer { animation: none !important; }
  .gold-border-sparkle, .gold-border-sparkle::after { animation: none; }
  .login-card { animation: none; transform: none; }
  .login-title { animation: none; }
}
